<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NOWCAST MESSAGE</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 16px;
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            gap: 20px;
            min-height: 100vh;
            position: relative;         }
        .container {
            flex: 1;
            max-width: 50%;
            display: flex;
            flex-direction: column;
        }
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
        }
        .form-group input[type="checkbox"] {
            margin-right: 10px;
        }
        .form-group button {
            width: 30%;
            padding: 10px;
            font-size: 16px;
            background-color: GREEN;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .form-group button:hover {
            background-color: GREY;
        }
        .alert {
            margin-top: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border: 1px solid #ddd;
            white-space: pre-wrap;
        }
        .button-group {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }
        .button-group button {
            width: 20%;
            font-size: 10px;
            padding: 05px;
            display: inline-block;
        }
        .button-group i {
            margin-right: 5px;
        }
        .footer {
            position: absolute; 
            bottom: 20px; 
            right: 20px; 
            text-align: right;
        }
        .footer img {
            width: 200px;
        }
        .checkbox-group label {
            display: inline-block;
            margin-right: 20px;
            margin-bottom: 10px;
        }
        .iframe-container {
            flex: 1;
            max-width: 800px;
            height: 600px;
            border: none;
        }
        .iframe-container iframe {
            width: 100%;
            height: 120%;
            border: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <form id="weatherAlertForm">
            <div class="form-group">
                <label for="alertDate">Date</label>
                <input type="date" id="alertDate" required>
            </div>
            <div class="form-group">
                <label for="alertTime">Time (24-hour format)</label>
                <input type="time" id="alertTime" required>
            </div>
            <div class="form-group checkbox-group">
                <label>Districts</label><br>
             <label><input type="checkbox" name="district" value="SRIKAKULAM">SRIKAKULAM</label>
             <label><input type="checkbox" name="district" value="PARVATHIPURAM MANYAM">PARVATHIPURAM MANYAM</label>
             <label><input type="checkbox" name="district" value="VIZIANAGARAM">VIZIANAGARAM</label>
            <label><input type="checkbox" name="district" value="VISAKHAPATNAM">VISAKHAPATNAM</label> 
            <label><input type="checkbox" name="district" value="ALLURI SITHARAMA RAJU">ALLURI SITHARAMA RAJU</label>
            <label><input type="checkbox" name="district" value="ANAKAPALLI">ANAKAPALLI</label>
            <label><input type="checkbox" name="district" value="KAKINADA">KAKINADA</label>
            <label><input type="checkbox" name="district" value="YANAM">YANAM</label>
            <label><input type="checkbox" name="district" value="Dr.B.R.AMBEDKAR KONASEEMA">Dr.B.R.AMBEDKAR KONASEEMA</label>
            <label><input type="checkbox" name="district" value="EAST GODAVARI">EAST GODAVARI</label>
            <label><input type="checkbox" name="district" value="WEST GODAVARI">WEST GODAVARI</label>
            <label><input type="checkbox" name="district" value="ELURU">ELURU</label>
            <label><input type="checkbox" name="district" value="NTR">NTR</label>
            <label><input type="checkbox" name="district" value="KRISHNA">KRISHNA</label>
            <label><input type="checkbox" name="district" value="GUNTUR">GUNTUR</label>
            <label><input type="checkbox" name="district" value="PALNADU">PALNADU</label>
            <label><input type="checkbox" name="district" value="BAPATLA">BAPATLA</label>
            <label><input type="checkbox" name="district" value="PRAKASAM">PRAKASAM</label>
            <label><input type="checkbox" name="district" value="SRI POTTI SRIRAMULU NELLORE">SRI POTTI SRIRAMULU NELLORE</label>
            <label><input type="checkbox" name="district" value="CHITTOOR">CHITTOOR</label>
            <label><input type="checkbox" name="district" value="TIRUPATI">TIRUPATI</label>
            <label><input type="checkbox" name="district" value="ANNAMAYYA">ANNAMAYYA</label>
            <label><input type="checkbox" name="district" value="YSR KADAPA">YSR KADAPA</label>
            <label><input type="checkbox" name="district" value="KURNOOL">KURNOOL</label>
            <label><input type="checkbox" name="district" value="NANDYAL">NANDYAL</label>
            <label><input type="checkbox" name="district" value="SRI SATHYA SAI">SRI SATHYA SAI</label>
            <label><input type="checkbox" name="district" value="ANANTAPUR">ANANTAPUR</label>
            </div>

   <div class="form-group">
                <button type="button" onclick="clearSelections()">Clear Selection</button>
          
            </div>

            <div class="form-group">
                <label for="thunderstormIntensity">Thunderstorm Intensity</label>
                <select id="thunderstormIntensity" required>
                    <option value="">Select...</option>
                    <option value="Light">Light</option>
                    <option value="Moderate">Moderate</option>
                    <option value="Severe">Severe</option>
                </select>
            </div>
            <div class="form-group">
                <label for="lightningLikelihood">Lightning Likelihood</label>
                <select id="lightningLikelihood" required>
                    <option value="">Select...</option>
                    <option value="likely">likely</option>
                    <option value="very likely">very likely</option>
                </select>
            </div>
            <div class="form-group">
            <label for="locationCoverage">Location Coverage</label>
            <select id="locationCoverage" required>
                <option value="">Select...</option>
                <option value="one or two places">one or two places</option>
                <option value="a few places">a few places</option>
                <option value="many places">many places</option>
                <option value="most places">most places</option>
            </select>
        </div>
        <div class="form-group">
            <label for="windDescription">Wind Description</label>
            <select id="windDescription" required>
                <option value="">Select...</option>
                <option value="strong gusty winds">strong gusty winds</option>
                <option value="squally winds">squally winds</option>
            </select>
        </div>
        <div class="form-group">
            <label for="windSpeed">Wind Speed</label>
            <select id="windSpeed" required>
                <option value="">Select...</option>
                <option value="40 kmph">40 kmph</option>
                <option value="45 kmph">45 kmph</option>
                <option value="50 kmph">50 kmph</option>
                <option value="55 kmph">55 kmph</option>
                <option value="60 kmph">60 kmph</option>
                <option value="65 kmph">65 kmph</option>
                <option value="70 kmph">70 kmph</option>
            </select>
        </div>
        <div class="form-group">
            <label for="rainfallIntensity">Rainfall Intensity</label>
            <select id="rainfallIntensity" required>
                <option value="">Select...</option>
                <option value="light">light</option>
                <option value="light to moderate">light to moderate</option>
                <option value="moderate">moderate</option>
                <option value="moderate to heavy">moderate to heavy</option>
                <option value="heavy">heavy</option>
            </select>
        </div>
        
            <div class="form-group">
                <button type="button" onclick="generateBothAlerts()">Generate Messages</button>
            </div>
        </form>
        <div id="alertWithoutEmails" class="alert" style="display: none;"></div>
        <div class="button-group" id="firstAlertButtons" style="display: none;">
            <button onclick="copyToClipboard('alertWithoutEmails')"><i class="fas fa-copy"></i> Copy Message for Whatsapp</button>
            <button onclick="shareOnWhatsApp('alertWithoutEmails')"><i class="fab fa-whatsapp"></i> WhatsApp</button>
        </div>
        <div id="alertWithEmails" class="alert" style="display: none;"></div>
        <div class="button-group" id="secondAlertButtons" style="display: none;">
            <button onclick="copyToClipboard('alertWithEmails')"><i class="fas fa-copy"></i> Copy Message for Gmail</button>
            <button onclick="sendViaGmail('alertWithEmails')"><i class="fas fa-envelope"></i> Gmail</button>
        </div>
    </div>
    <div class="iframe-container">
        <iframe src="https://ildn.in/" title="Embedded Webpage"></iframe>
    </div>

    <div class="footer">
        <p style="margin: 0;">
            <span><b>꧁<i>SAI CHARAN</i>꧂</b></span>
        </p>
    </div>

    <script>

  function clearSelections() {
            const checkboxes = document.querySelectorAll('input[name="district"]');
            checkboxes.forEach(checkbox => {
                checkbox.checked = false;
            });
        }

        function formatDateString(dateString) {
            const date = new Date(dateString);
            const day = date.getDate().toString().padStart(2, '0');
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const year = date.getFullYear().toString(); 
            return `${day}-${month}-${year}`;
        }

        function formatTimeString(timeString) {
            return timeString; 
        }

        const districtEmails = {
             "PARVATHIPURAM MANYAM": "collector-pmanyam@ap.gov.in",
            "SRIKAKULAM": "collector_sklm@ap.gov.in,collector.sklm@gmail.com,dsectionsklm@gmail.com",
            "VISAKHAPATNAM": "collector_vspm@ap.gov.in,collectorpeshivizag@gmail.com,drovskds@gmail.com,dtc_visakhapatnam@aptransport.org,commissioner_gvmc@yahoo.co.in,sru.gvmc@gmail.com",
            "VIZIANAGARAM": "collector_vznm@ap.gov.in",
            "ALLURI SITHARAMA RAJU": "collectorasrdistrict@gmail.com,collector-alluri@ap.gov.in",
            "ANAKAPALLI": "collector-ankp@ap.gov.in,collectorpeshianakapalli@gmail.com,collectoranakapalli@gmail.com",
            "KAKINADA": "collector-kkd@ap.gov.in",
            "Dr.B.R.AMBEDKAR KONASEEMA": "collector-ksm@ap.gov.in",
            "EAST GODAVARI": "collector_egd@ap.gov.in,collectoregd@gmail.com",
            "WEST GODAVARI": "collector_wgd@ap.gov.in,collectorwestgodavari@gmail.com",
            "ELURU": "collector-eluru@ap.gov.in,collectoreluru@gmail.com",
            "NTR": "collector-ntr@ap.gov.in,collector.ntr@gmail.com",
            "KRISHNA": "collector-ksn@ap.gov.in,collector_krsn@ap.gov.in,kricoll123@gmail.com",
            "GUNTUR": "dsectionguntur@gmail.com,collector_gntr@ap.gov.in",
            "PALNADU": "collector-palnadu@ap.gov.in,",
            "BAPATLA": "collector-bapatla@ap.gov.in,collectorbapatla@gmail.com",
            "PRAKASAM": "collector_prk@ap.gov.in,collector_pkm@ap.gov.in,",
            "SRI POTTI SRIRAMULU NELLORE": "collector_nlr@ap.gov.in",
            "CHITTOOR": "collector_cttr@ap.gov.in,dro.cttr@gmail.com,collectorchittoor@gmail.com",
            "TIRUPATI": "collector.tirupati@ap.gov.in",
            "ANNAMAYYA": "collector_annamayya@ap.gov.in,collector.annamayya@gmail.com",
            "YSR KADAPA": "collector_kdp@ap.gov.in",
            "KURNOOL": "collector_krnl@ap.gov.in,kurnoolcollector@gmail.com",
            "NANDYAL": "collector-nandyal@ap.gov.in,nandyalcollector@gmail.com",
            "SRI SATHYA SAI": "collector.sssai@ap.gov.in",
            "ANANTAPUR": "collector_antp@ap.gov.in", };

      function validateForm() {
            const alertDate = document.getElementById('alertDate').value;
            const alertTime = document.getElementById('alertTime').value;
            const selectedDistricts = document.querySelectorAll('input[name="district"]:checked');
            const thunderstormIntensity = document.getElementById('thunderstormIntensity').value;
            const lightningLikelihood = document.getElementById('lightningLikelihood').value;
            const locationCoverage = document.getElementById('locationCoverage').value;
            const windDescription = document.getElementById('windDescription').value;
            const windSpeed = document.getElementById('windSpeed').value;
            const rainfallIntensity = document.getElementById('rainfallIntensity').value;

            if (!alertDate || !alertTime || selectedDistricts.length === 0 || !thunderstormIntensity || !lightningLikelihood || !locationCoverage || !windDescription || !windSpeed || !rainfallIntensity) {
                alert('Please fill all fields before generating.');
                return false;
            }
            return true;
        }


 function generateFirstAlert() {
    if (!validateForm()) return;

    const alertDate = formatDateString(document.getElementById('alertDate').value);
    const alertTime = formatTimeString(document.getElementById('alertTime').value);
    const selectedDistricts = Array.from(document.querySelectorAll('input[name="district"]:checked')).map(el => el.value);
    const thunderstormIntensity = document.getElementById('thunderstormIntensity').value;
    const lightningLikelihood = document.getElementById('lightningLikelihood').value;
    const locationCoverage = document.getElementById('locationCoverage').value;
    const windDescription = document.getElementById('windDescription').value;
    const windSpeed = document.getElementById('windSpeed').value;
    const rainfallIntensity = document.getElementById('rainfallIntensity').value;

    let districtString = '';
    const yanamIncluded = selectedDistricts.includes('YANAM');

      if (yanamIncluded) {
         const otherDistricts = selectedDistricts.filter(district => district !== 'YANAM');
        districtString = otherDistricts.length > 0 ? otherDistricts.join(', ') + (otherDistricts.length > 1 ? ' districts and YANAM' : ' district and YANAM'): 'YANAM';


    } else {
        districtString = selectedDistricts.length > 1 
            ? selectedDistricts.slice(0, -1).join(', ') + ' and ' + selectedDistricts.slice(-1)
            : selectedDistricts[0] || 'N/A';
    }

    const alertMessage = `*CWC-Visakhapatnam/Date:${alertDate} at ${alertTime} HRS IST:*\n\n${thunderstormIntensity} Thunderstorm with lightning ${lightningLikelihood} to occur at ${locationCoverage} over ${districtString} ${yanamIncluded ? '' : (selectedDistricts.length === 1 ? "district" : "districts")} within next 03 hours. It will be accompanied with ${windDescription} reaching ${windSpeed} or more. It could be accompanied by ${rainfallIntensity} rainfall.\n===`;

    const alertWithoutEmails = document.getElementById('alertWithoutEmails');
    alertWithoutEmails.textContent = alertMessage;
    alertWithoutEmails.style.display = 'block';
    document.getElementById('firstAlertButtons').style.display = 'flex';
}

function generateSecondAlert() {
    if (!validateForm()) return;

    const alertDate = formatDateString(document.getElementById('alertDate').value);
    const alertTime = formatTimeString(document.getElementById('alertTime').value);
    const selectedDistricts = Array.from(document.querySelectorAll('input[name="district"]:checked')).map(el => el.value);
    const thunderstormIntensity = document.getElementById('thunderstormIntensity').value;
    const lightningLikelihood = document.getElementById('lightningLikelihood').value;
    const locationCoverage = document.getElementById('locationCoverage').value;
    const windDescription = document.getElementById('windDescription').value;
    const windSpeed = document.getElementById('windSpeed').value;
    const rainfallIntensity = document.getElementById('rainfallIntensity').value;

    const fixedEmails = [
        "APDATA 2021 <apdata2021@gmail.com>",
        "apsdma@ap.gov.in",
        "Amaravati Met Centre <mc.amaravati@gmail.com>",
        "APSDMA SEOC <seoc-apsdma@ap.gov.in>",
        "IMD Weather Channel <wxchannel@gmail.com>",
        "Met Centre Amaravati IMD <mcamaravati.ws@imd.gov.in>",
        "Nowcast Division <nowcastdivision@gmail.com>",
        "nwfc weather <wxchannel1@gmail.com>"
    ];

    const districtEmailsList = selectedDistricts.map(district => districtEmails[district]);
    let districtString = '';
    const yanamIncluded = selectedDistricts.includes('YANAM');

    if (yanamIncluded) {
         const otherDistricts = selectedDistricts.filter(district => district !== 'YANAM');
        districtString = otherDistricts.length > 0 ? otherDistricts.join(', ') + (otherDistricts.length > 1 ? ' districts and YANAM' : ' district and YANAM'): 'YANAM';

    } else {
        districtString = selectedDistricts.length > 1 
            ? selectedDistricts.slice(0, -1).join(', ') + ' and ' + selectedDistricts.slice(-1)
            : selectedDistricts[0] || 'N/A';
    }

    const alertMessage = `District Severe Weather Warning Dated ${alertDate} at ${alertTime} HRS IST.\n\n${districtEmailsList.join(', ')}${fixedEmails.length > 0 ? ', ' + fixedEmails.join(', ') : ''}\n\nCWC-Visakhapatnam/Date:${alertDate} at ${alertTime} HRS IST:\n\n${thunderstormIntensity} Thunderstorm with lightning ${lightningLikelihood} to occur at ${locationCoverage} over ${districtString} ${yanamIncluded ? '' : (selectedDistricts.length === 1 ? "district" : "districts")} within next 03 hours. It will be accompanied with ${windDescription} reaching ${windSpeed} or more. It could be accompanied by ${rainfallIntensity} rainfall.\n===`;

    const alertWithEmails = document.getElementById('alertWithEmails');
    alertWithEmails.textContent = alertMessage;
    alertWithEmails.style.display = 'block';
    document.getElementById('secondAlertButtons').style.display = 'flex';
}

        function copyToClipboard(elementId) {
            const text = document.getElementById(elementId).textContent;
            navigator.clipboard.writeText(text).then(() => {
                alert("Copied to clipboard");
            }).catch(err => {
                console.error('Failed to copy: ', err);
            });
        }

        function shareOnWhatsApp(elementId) {
            const text = encodeURIComponent(document.getElementById(elementId).textContent);
            const whatsappUrl = `https://api.whatsapp.com/send?text=${text}`;
            window.open(whatsappUrl, '_blank');
        }
function sendViaGmail(elementId) {
    const alertDate = formatDateString(document.getElementById('alertDate').value);
    const alertTime = formatTimeString(document.getElementById('alertTime').value);
    const text = document.getElementById(elementId).textContent;

    const alertStart = "CWC-Visakhapatnam/Date:";
    const startIndex = text.indexOf(alertStart);

    const alertMessage = text.substring(startIndex).trim();

    const selectedDistricts = Array.from(document.querySelectorAll('input[name="district"]:checked')).map(el => el.value);
    const districtEmailsList = selectedDistricts.map(district => districtEmails[district]);
    const allEmails = districtEmailsList.flat().concat([
        "apdata2021@gmail.com",
        "apsdma@ap.gov.in",
        "mc.amaravati@gmail.com",
        "seoc-apsdma@ap.gov.in",
        "wxchannel@gmail.com",
        "mcamaravati.ws@imd.gov.in",
        "nowcastdivision@gmail.com",
        "wxchannel1@gmail.com"
    ]).join(',');


    const gmailUrl = `https://mail.google.com/mail/?view=cm&fs=1&to=${encodeURIComponent(allEmails)}&su=District%20severe%20weather%20warning%20dated%20${encodeURIComponent(alertDate)}%20at%20${encodeURIComponent(alertTime)}%20HRS%20IST&body=${encodeURIComponent(alertMessage)}`;
    window.open(gmailUrl, '_blank');
}


               function generateBothAlerts() {
            generateFirstAlert();
            generateSecondAlert();
        }
    </script>
</body>
</html>